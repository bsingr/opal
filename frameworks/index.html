<html>
<head>
	<!-- ================== -->
	<!-- = CoreFoundation = -->
	<!-- ================== -->
	<script src="CoreFoundation/CFArray.js" type="text/javascript" charset="utf-8"></script>
	<script src="CoreFoundation/CFAttributedString.js" type="text/javascript" charset="utf-8"></script>
	<script src="CoreFoundation/CFBase.js" type="text/javascript" charset="utf-8"></script>
	<script src="CoreFoundation/CFData.js" type="text/javascript" charset="utf-8"></script>
	<script src="CoreFoundation/CFDate.js" type="text/javascript" charset="utf-8"></script>
	<script src="CoreFoundation/CFPropertyList.js" type="text/javascript" charset="utf-8"></script>
	<script src="CoreFoundation/CFString.js" type="text/javascript" charset="utf-8"></script>
	<script src="CoreFoundation/CFDictionary.js" type="text/javascript" charset="utf-8"></script>
	<script src="CoreFoundation/CFJSONParser.js" type="text/javascript" charset="utf-8"></script>
	
	<!-- ================ -->
	<!-- = CoreGraphics = -->
	<!-- ================ -->
	<script src="CoreGraphics/CGAffineTransform.js" type="text/javascript" charset="utf-8"></script>
	<script src="CoreGraphics/CGBitmapContext.js" type="text/javascript" charset="utf-8"></script>
	<script src="CoreGraphics/CGContext.js" type="text/javascript" charset="utf-8"></script>
	<script src="CoreGraphics/CGGeometry.js" type="text/javascript" charset="utf-8"></script>
	<script src="CoreGraphics/CGDOMElement.js" type="text/javascript" charset="utf-8"></script>
	<script src="CoreGraphics/CGImage.js" type="text/javascript" charset="utf-8"></script>
	<!-- <script src="CoreGraphics/CGDOMContext.js" type="text/javascript" charset="utf-8"></script>-->
	
	<!-- ======== -->
	<!-- = objc = -->
	<!-- ======== -->
	<script src="objc/message.js" type="text/javascript" charset="utf-8"></script>
	<script src="objc/objc.js" type="text/javascript" charset="utf-8"></script>
	<script src="objc/runtime.js" type="text/javascript" charset="utf-8"></script>
	<script src="objc/objc-exception.js" type="text/javascript" charset="utf-8"></script>
	
	<!-- ====================== -->
	<!-- = Testing frameworks = -->
	<!-- ====================== -->
	<script type="text/javascript" charset="utf-8">
	
		var theParser = CFJSONParserCreate('{"plist": {"version": "1.0","dict": {"CFBundleDevelopmentRegion": {"string": "English"},"CFBundleExecutable": {"string": "myApp"},"CFBundleIconFile": {"string": ""},"CFBundleIdentifier": {"string": "com.adambeynon.vienna"},"CFBundleInfoDictionaryVersion": {"string": "6.0"},"CFBundleName": {"string": "My Awesome application"},"CFBundlePackageType": {"string": "AAPL"},"CFBundleSignature": {"string": "????"},"CFBundleVersion": {"string": "1.0"},"NSMainNibFile": {"string": "MainMenu"},"NSPrincipalClass": {"string": "NSApplication"}}}}');
		
		CFJSONParserParse(theParser);
		
		function main()
		{
			// =======================================================
			// =                NSObject and co                      =
			// =======================================================
			var the_class = objc_allocateClassPair(null, "NSObject");
			var meta_class = the_class.isa;
			objc_registerClassPair(the_class);
			
			class_addIvar(the_class, "age", "int");
			
			class_addMethod(the_class, "init", function(self, _cmd) {
				return self;
			}, "id");
			
			class_addMethod(meta_class, "alloc", function(self, _cmd) {
				return class_createInstance(self);
			});
			
			// ========================================================
			// =              NSArray                                 =
			// ========================================================
			var the_class = objc_allocateClassPair(NSObject, "NSArray");
			var meta_class = the_class.isa;
			objc_registerClassPair(the_class);
			
			class_addIvar(the_class, "arrayDepth", "int");
			
			class_addMethod(the_class, "count", function(self, _cmd) {
				console.log("Returning count")
			}, "id");
			
			// ========================================================
			// =              NSKeyValueCoding                        =
			// ========================================================
			var the_class = NSObject;
			class_addMethod(the_class, "valueForKey:", function(self, _cmd, key) {
				return key;
			}, "id");
			
			
			// ====================================================
			// =            NSDictionary                          =
			// ====================================================
			var the_class = objc_allocateClassPair(NSObject, "NSDictionary");
			var meta_class = the_class.isa;
			objc_registerClassPair(the_class);
					
			class_addMethod(the_class, "init", function(self, _cmd) {
				self = objc_msgSendSuper({super_class:NSObject, receiver:self}, "init");
				return self;
			}, "id");
				
			class_addMethod(the_class, "initWithKeys:values:", function(self, _cmd, keys, values) {
			}, "id");
			
			// =======================
			// = NSMutableDictionary =
			// =======================
			var the_class = objc_allocateClassPair(NSDictionary, "NSMutableDictionary");
			var meta_class = the_class.isa;
			objc_registerClassPair(the_class);
							
			// =============================
			// = Creating demo classes etc =
			// =============================		
			
			var myDict = objc_msgSend(objc_msgSend(NSMutableDictionary, "alloc"), "init");
			console.log(objc_msgSend(myDict, "valueForKey:", "heyaa"));


			// ========================
			// = Playing with the DOM =
			// ========================
			
			var theCanvas = CGDOMElementCreate("canvas");
									CGDOMElementAppendChild(CGDOMElementGetRootElement(), theCanvas);
									var theContext = CGDOMElementGetContext(theCanvas);
									CGContextStrokeRect(theContext, CGRectMake(0.5,0.5,100,100));
	
		}
	</script>
</head>
<body id="index" onload="javascript:main()">

</body>
</html>