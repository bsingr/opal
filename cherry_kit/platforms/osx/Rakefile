require 'fileutils'

BUILD_DIR = File.join(Dir.getwd, 'build')
OUTPUT = File.join(BUILD_DIR, "cherry_kit")
SOURCES = Dir.glob(File.join(File.dirname(__FILE__), 'lib', '**', '*.{m,c}'))


desc "Build OS X CherryKit binary"
task :build do
  # purely build binary that is ready to ship in Mac OS folder of app
  FileUtils.mkdir_p(BUILD_DIR)
  # SOURCES.each do |source|
  %x{gcc #{SOURCES.join(" ")} -o #{OUTPUT} -framework Cocoa -framework Ruby}
  # end
end

task :default => [:build]
